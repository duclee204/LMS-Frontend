<div class="courses-container">
  <div class="header">
    <h1 class="title">
      <span *ngIf="userRole === 'instructor' || userRole === 'ROLE_instructor'">KhÃ³a há»c cá»§a tÃ´i</span>
      <span *ngIf="userRole === 'student' || userRole === 'ROLE_student'">Táº¥t cáº£ khÃ³a há»c</span>
      <span *ngIf="!userRole">Danh sÃ¡ch khÃ³a há»c</span>
    </h1>
    <p class="subtitle" *ngIf="userName">
      Xin chÃ o, {{ userName }}
      <span *ngIf="userRole === 'instructor' || userRole === 'ROLE_instructor'">(Giáº£ng viÃªn)</span>
      <span *ngIf="userRole === 'student' || userRole === 'ROLE_student'">(Sinh viÃªn)</span>
      <small style="color: #888; display: block; margin-top: 4px;">
        Debug: Role = "{{ userRole }}", Courses = {{ courses.length }}
      </small>
    </p>
  </div>

  <!-- Loading state -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Äang táº£i khÃ³a há»c...</p>
  </div>

  <!-- Empty state -->
  <div *ngIf="!loading && courses.length === 0 && userRole" class="empty-state">
    <div class="empty-icon">ğŸ“š</div>
    <h3 *ngIf="userRole === 'instructor' || userRole === 'ROLE_instructor'">Báº¡n chÆ°a táº¡o khÃ³a há»c nÃ o</h3>
    <h3 *ngIf="userRole === 'student' || userRole === 'ROLE_student'">KhÃ´ng cÃ³ khÃ³a há»c nÃ o</h3>
    <p *ngIf="userRole === 'instructor' || userRole === 'ROLE_instructor'">HÃ£y táº¡o khÃ³a há»c Ä‘áº§u tiÃªn Ä‘á»ƒ báº¯t Ä‘áº§u giáº£ng dáº¡y!</p>
    <p *ngIf="userRole === 'student' || userRole === 'ROLE_student'">Há»‡ thá»‘ng chÆ°a cÃ³ khÃ³a há»c nÃ o Ä‘á»ƒ hiá»ƒn thá»‹!</p>
  </div>

  <!-- Courses grid -->
  <div *ngIf="!loading && courses.length > 0 && userRole" class="courses-grid">
    <div *ngFor="let course of courses" class="course-card" 
         [class.enrolled]="course.enrolled" 
         [class.not-enrolled]="!course.enrolled && (userRole === 'student' || userRole === 'ROLE_student')">
      
      <div class="course-header">
        <h3 class="course-title">{{ getCourseTitle(course) }}</h3>
        
        <!-- Tráº¡ng thÃ¡i khÃ³a há»c cho giáº£ng viÃªn -->
        <span *ngIf="userRole === 'instructor' || userRole === 'ROLE_instructor'" 
              class="course-status" [class]="course.status">
          {{ course.status === 'published' ? 'ÄÃ£ xuáº¥t báº£n' : 'NhÃ¡p' }}
        </span>
        
        <!-- Tráº¡ng thÃ¡i Ä‘Äƒng kÃ½ cho sinh viÃªn -->
        <span *ngIf="userRole === 'student' || userRole === 'ROLE_student'" 
              class="enrollment-status" 
              [class.enrolled]="course.enrolled"
              [class.not-enrolled]="!course.enrolled">
          {{ course.enrolled ? 'âœ… ÄÃ£ Ä‘Äƒng kÃ½' : 'âŒ ChÆ°a Ä‘Äƒng kÃ½' }}
        </span>
      </div>

      <div class="course-info">
        <p class="course-description">
          {{ getCourseDescription(course) }}
        </p>

        <div class="course-meta">
          <div class="meta-item" *ngIf="getCoursePrice(course)">
            <span class="meta-label">GiÃ¡:</span>
            <span class="meta-value price">{{ formatPrice(getCoursePrice(course)) }}</span>
          </div>
          
          <div class="meta-item">
            <span class="meta-label">NgÃ y táº¡o:</span>
            <span class="meta-value">{{ formatDate(getCourseCreatedDate(course)) }}</span>
          </div>

          <div class="meta-item" *ngIf="course.categoryName">
            <span class="meta-label">Danh má»¥c:</span>
            <span class="meta-value">{{ course.categoryName }}</span>
          </div>

          <div class="meta-item" *ngIf="(userRole === 'student' || userRole === 'ROLE_student') && course.enrolledAt">
            <span class="meta-label">NgÃ y Ä‘Äƒng kÃ½:</span>
            <span class="meta-value">{{ formatDate(course.enrolledAt) }}</span>
          </div>
        </div>
      </div>

      <div class="course-actions">
        <button 
          class="btn" 
          [class.btn-primary]="course.enrolled || (userRole === 'instructor' || userRole === 'ROLE_instructor')"
          [class.btn-success]="!course.enrolled && (userRole === 'student' || userRole === 'ROLE_student')"
          (click)="enterCourse(course)"
          [disabled]="loading"
          [title]="(userRole === 'instructor' || userRole === 'ROLE_instructor') ? 'Quáº£n lÃ½ khÃ³a há»c' : (course.enrolled ? 'VÃ o há»c' : 'ÄÄƒng kÃ½ & vÃ o há»c')"
        >
          <span *ngIf="loading">â³ Äang xá»­ lÃ½...</span>
          <span *ngIf="!loading && (userRole === 'instructor' || userRole === 'ROLE_instructor')">ğŸ“Š Quáº£n lÃ½</span>
          <span *ngIf="!loading && (userRole === 'student' || userRole === 'ROLE_student') && course.enrolled">ğŸ“ VÃ o há»c</span>
          <span *ngIf="!loading && (userRole === 'student' || userRole === 'ROLE_student') && !course.enrolled">ğŸ“ ÄÄƒng kÃ½ ngay</span>
          <span *ngIf="!loading && !userRole">ğŸ‘ï¸ Xem</span>
        </button>

        <button 
          class="btn btn-secondary" 
          (click)="viewCourseDetails(course)"
          [disabled]="loading"
          title="Xem video cá»§a khÃ³a há»c"
        >
          ğŸ¥ Xem video
        </button>
      </div>
    </div>
  </div>
</div>
